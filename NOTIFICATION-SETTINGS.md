# ğŸ”” RÃ©glages des Notifications - Documentation

## âœ… Ã‰cran CrÃ©Ã©

La page **Notification Settings** est maintenant disponible ! ğŸ‰

---

## ğŸ¨ Design System AppliquÃ©

### Couleurs
- **Fond** : `bg-slate-950` (#020617)
- **Cartes** : `bg-slate-900` (#0f172a)
- **Bordures** : `border-slate-800` (#1e293b)
- **Titres de section** : `text-slate-400` (gris clair)
- **Texte principal** : `text-white`
- **Descriptions** : `text-slate-400`
- **Switch ON** : `bg-yellow-400` (#facc15)
- **Switch OFF** : Gris sombre par dÃ©faut

---

## ğŸ“± Structure de l'Ã‰cran

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† PrÃ©fÃ©rences Notifications        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  ğŸ”” COURSES                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Nouvelle proposition        ğŸŸ¡â”‚  â”‚
â”‚  â”‚ Soyez alertÃ© dÃ¨s qu'une...  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Annulation / Modification   ğŸŸ¡â”‚  â”‚
â”‚  â”‚ Si le client change...      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  ğŸ’¬ MESSAGES                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Messages Clients            ğŸŸ¡â”‚  â”‚
â”‚  â”‚ Chat en direct...           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Support One Connexion       ğŸŸ¡â”‚  â”‚
â”‚  â”‚ Messages importants...      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  ğŸ’° ADMINISTRATIF                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Paiements ReÃ§us             ğŸŸ¡â”‚  â”‚
â”‚  â”‚ Notif quand un virement...  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Alertes Documents           ğŸŸ¡â”‚  â”‚
â”‚  â”‚ Rappels avant expiration... â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”‚  ğŸ’¡ Les notifications de nouvelles â”‚
â”‚     courses sont recommandÃ©es...   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ FonctionnalitÃ©s

### 3 Sections OrganisÃ©es

#### 1ï¸âƒ£ **COURSES** (Critique)
- âœ… **Nouvelle proposition de course**
  - Description : Soyez alertÃ© dÃ¨s qu'une course est disponible autour de vous
  - Par dÃ©faut : **ON** (critique pour le business)
  
- âœ… **Annulation / Modification**
  - Description : Si le client change l'adresse ou annule
  - Par dÃ©faut : **ON**

#### 2ï¸âƒ£ **MESSAGES**
- âœ… **Messages Clients**
  - Description : Chat en direct pendant une livraison
  - Par dÃ©faut : **ON**
  
- âœ… **Support One Connexion**
  - Description : Messages importants de l'administration
  - Par dÃ©faut : **ON**

#### 3ï¸âƒ£ **ADMINISTRATIF**
- âœ… **Paiements ReÃ§us**
  - Description : Notif quand un virement arrive sur votre compte
  - Par dÃ©faut : **ON**
  
- âœ… **Alertes Documents**
  - Description : Rappels avant expiration du permis ou assurance
  - Par dÃ©faut : **ON**

---

## âš™ï¸ Logique Technique

### Ã‰tat Local
```tsx
const [settings, setSettings] = useState<NotificationSettings>({
  // Courses
  newOrder: true,
  orderCancellation: true,
  
  // Messages
  clientMessages: true,
  supportMessages: true,
  
  // Administratif
  payments: true,
  documentAlerts: true,
});
```

### Toggle Switch
```tsx
const toggleSwitch = (key: keyof NotificationSettings) => {
  setSettings(prev => {
    const newSettings = { ...prev, [key]: !prev[key] };
    
    // Simulate saving to backend
    // In production: await supabase.from('driver_settings').update(...)
    
    toast({
      title: 'PrÃ©fÃ©rences mises Ã  jour',
      description: `Notifications ${newSettings[key] ? 'activÃ©es' : 'dÃ©sactivÃ©es'}`,
    });
    
    return newSettings;
  });
};
```

---

## ğŸ”— Navigation

### Depuis Profile
```tsx
// Dans Profile.tsx
if (action === 'notifications') {
  navigate('/notifications/settings');
  return;
}
```

### Route
```tsx
// Dans App.tsx
<Route path="/notifications/settings" element={
  <ProtectedRoute>
    <NotificationSettings />
  </ProtectedRoute>
} />
```

---

## ğŸ¯ UX/UI

### Switches Jaunes
- **ON** : `bg-yellow-400` (jaune vif)
- **OFF** : Gris sombre par dÃ©faut
- Animation fluide au toggle

### Toast de Confirmation
Chaque changement affiche un toast :
- "PrÃ©fÃ©rences mises Ã  jour"
- "Notifications activÃ©es" ou "Notifications dÃ©sactivÃ©es"

### Info Footer
Message informatif en bas :
> ğŸ’¡ Les notifications de nouvelles courses sont fortement recommandÃ©es pour ne manquer aucune opportunitÃ©.

---

## ğŸ“Š IntÃ©gration Supabase (Ã€ Faire)

### Table `driver_settings`

```sql
CREATE TABLE driver_settings (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  driver_id UUID REFERENCES drivers(id) ON DELETE CASCADE,
  
  -- Courses
  new_order_notif BOOLEAN DEFAULT true,
  order_cancellation_notif BOOLEAN DEFAULT true,
  
  -- Messages
  client_messages_notif BOOLEAN DEFAULT true,
  support_messages_notif BOOLEAN DEFAULT true,
  
  -- Administratif
  payments_notif BOOLEAN DEFAULT true,
  document_alerts_notif BOOLEAN DEFAULT true,
  
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  
  UNIQUE(driver_id)
);
```

### Code de Sauvegarde

**Remplacer dans `toggleSwitch()` :**

```tsx
// Simulate saving to backend
// In production:
const { error } = await supabase
  .from('driver_settings')
  .upsert({
    driver_id: driver?.id,
    new_order_notif: newSettings.newOrder,
    order_cancellation_notif: newSettings.orderCancellation,
    client_messages_notif: newSettings.clientMessages,
    support_messages_notif: newSettings.supportMessages,
    payments_notif: newSettings.payments,
    document_alerts_notif: newSettings.documentAlerts,
    updated_at: new Date().toISOString(),
  }, {
    onConflict: 'driver_id'
  });

if (error) {
  console.error('Error saving settings:', error);
  toast({
    title: 'Erreur',
    description: 'Impossible de sauvegarder les prÃ©fÃ©rences',
    variant: 'destructive',
  });
  return prev; // Revert changes
}
```

### Chargement Initial

**Ajouter dans `useEffect()` :**

```tsx
useEffect(() => {
  const loadSettings = async () => {
    const { data, error } = await supabase
      .from('driver_settings')
      .select('*')
      .eq('driver_id', driver?.id)
      .single();

    if (data) {
      setSettings({
        newOrder: data.new_order_notif,
        orderCancellation: data.order_cancellation_notif,
        clientMessages: data.client_messages_notif,
        supportMessages: data.support_messages_notif,
        payments: data.payments_notif,
        documentAlerts: data.document_alerts_notif,
      });
    }
  };

  if (driver?.id) {
    loadSettings();
  }
}, [driver?.id]);
```

---

## ğŸ§ª Tester

Le serveur est lancÃ© sur **http://localhost:8080**

1. **Connecte-toi** (auto-login âœ…)
2. **Va sur Profile**
3. **Clique sur "Notifications"**
4. **Teste les switches** :
   - Clique pour activer/dÃ©sactiver
   - VÃ©rifie le toast de confirmation
   - VÃ©rifie le changement de couleur (jaune/gris)

---

## âœ¨ Points Forts

- âœ… **Design cohÃ©rent** avec le reste de l'app
- âœ… **3 sections claires** (Courses, Messages, Administratif)
- âœ… **Switches jaunes** pour la marque
- âœ… **Toast de confirmation** Ã  chaque changement
- âœ… **Descriptions claires** pour chaque option
- âœ… **IcÃ´nes** pour identifier les sections
- âœ… **Info footer** pour guider l'utilisateur
- âœ… **PrÃªt pour Supabase** (code prÃ©parÃ©)

---

## ğŸ“‹ Checklist

- [x] Page crÃ©Ã©e (`NotificationSettings.tsx`)
- [x] Route ajoutÃ©e (`/notifications/settings`)
- [x] Navigation depuis Profile
- [x] Design dark appliquÃ©
- [x] Switches fonctionnels
- [x] Toast de confirmation
- [x] 6 options de notifications
- [x] 3 sections organisÃ©es
- [ ] IntÃ©gration Supabase (Ã  faire)
- [ ] Notifications push natives (Ã  faire)

---

**Page de rÃ©glages des notifications terminÃ©e ! ğŸ””âœ¨**
